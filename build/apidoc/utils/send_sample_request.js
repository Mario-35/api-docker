define(["jquery"],(function(e){function a(){e('[data-spy="scroll"]').each((function(){e(this).scrollspy("refresh")}))}return{initDynamic:function(){e(".sample-request-send").off("click"),e(".sample-request-send").on("click",(function(r){r.preventDefault();var t=e(this).parents("article");!function(r,t,s,n){var l=e('article[data-group="'+r+'"][data-name="'+t+'"][data-version="'+s+'"]'),u={};l.find(".sample-request-header").each((function(a,r){var t=e(r).data("sample-request-header-group");l.find('[data-sample-request-header-group="'+t+'"]').each((function(a,r){var t=e(r).data("sample-request-header-name"),s=r.value;r.optional||""===r.defaultValue||(s=r.defaultValue),u[t]=s}))}));var p={},o={};l.find(".sample-request-param").each((function(a,r){var t=e(r).data("sample-request-param-group");l.find('[data-sample-request-param-group="'+t+'"]').each((function(a,r){var t=e(r).data("sample-request-param-name"),s=r.value;r.optional||""===r.defaultValue||(s=r.defaultValue),p[t]=s,o[t]=e(r).next().text()}))}));for(var i=l.find(".sample-request-url").val(),d=pathToRegexp(i,null).exec(i),c=1;c<d.length;c++){var f=d[c].substr(1);void 0!==p[f]&&(i=i.replace(d[c],encodeURIComponent(p[f])),delete p[f])}l.find(".sample-request-response").fadeTo(250,1),l.find(".sample-request-response-json").html("Loading..."),a(),_.each(p,(function(e,a){var r=o[a].toLowerCase();if("object"===r||"array"===r)try{p[a]=JSON.parse(e)}catch(e){}}));var m={url:i,headers:u,data:p,type:n.toUpperCase(),success:function(e,r,t){var s;try{s=JSON.parse(t.responseText),s=JSON.stringify(s,null,4)}catch(a){s=e}l.find(".sample-request-response-json").html(s),a()},error:function(e,r,t){var s,n="Error "+e.status+": "+t;try{s=JSON.parse(e.responseText),s=JSON.stringify(s,null,4)}catch(a){s=escape(e.responseText)}s&&(n+="<br>"+s);l.find(".sample-request-response").is(":visible")&&l.find(".sample-request-response").fadeTo(1,.1);l.find(".sample-request-response").fadeTo(250,1),l.find(".sample-request-response-json").html(n),a()}};e.ajax(m)}(t.data("group"),t.data("name"),t.data("version"),e(this).data("sample-request-type"))})),e(".sample-request-clear").off("click"),e(".sample-request-clear").on("click",(function(r){r.preventDefault();var t=e(this).parents("article");!function(r,t,s){var n=e('article[data-group="'+r+'"][data-name="'+t+'"][data-version="'+s+'"]');n.find(".sample-request-response-json").html(""),n.find(".sample-request-response").hide(),n.find(".sample-request-param").each((function(e,a){a.value=""}));var l=n.find(".sample-request-url");l.val(l.prop("defaultValue")),a()}(t.data("group"),t.data("name"),t.data("version"))}))}}}));