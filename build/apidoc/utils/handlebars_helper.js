define(["locales","handlebars","diffMatchPatch"],(function(e,r,n){var t;r.registerHelper("startTimer",(function(e){return t=new Date,""})),r.registerHelper("stopTimer",(function(e){return console.log(new Date-t),""})),r.registerHelper("__",(function(r){return e.__(r)})),r.registerHelper("cl",(function(e){return console.log(e),""})),r.registerHelper("underscoreToSpace",(function(e){return e.replace(/(_+)/g," ")})),r.registerHelper("assign",(function(e){if(arguments.length>0){var n=typeof arguments[1],t=null;"string"!==n&&"number"!==n&&"boolean"!==n||(t=arguments[1]),r.registerHelper(e,(function(){return t}))}return""})),r.registerHelper("nl2br",(function(e){return a(e)})),r.registerHelper("if_eq",(function(e,r){var n=e;return e instanceof Object&&!(r.hash.compare instanceof Object)&&(n=Object.keys(e).length),n===r.hash.compare?r.fn(this):r.inverse(this)})),r.registerHelper("if_gt",(function(e,r){var n=e;return e instanceof Object&&!(r.hash.compare instanceof Object)&&(n=Object.keys(e).length),n>r.hash.compare?r.fn(this):r.inverse(this)}));var i={};function a(e){return(""+e).replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br>$2")}function c(e,r,n,t){var i=[],a=0;r&&r.forEach((function(r){var t=!1;if(n&&n.forEach((function(n){if(r[e]===n[e]){var c={typeSame:!0,source:r,compare:n,index:a};i.push(c),t=!0,a++}})),!t){var c={typeIns:!0,source:r,index:a};i.push(c),a++}})),n&&n.forEach((function(n){var t=!1;if(r&&r.forEach((function(r){r[e]===n[e]&&(t=!0)})),!t){var c={typeDel:!0,compare:n,index:a};i.push(c),a++}}));var c="",o=i.length;for(var a in i)a==o-1&&(i[a]._last=!0),c+=t.fn(i[a]);return c}r.registerHelper("subTemplate",(function(e,n){i[e]||(i[e]=r.compile($("#template-"+e).html()));var t=i[e],a=$.extend({},this,n.hash);return new r.SafeString(t(a))})),r.registerHelper("toLowerCase",(function(e){return e&&"string"==typeof e?e.toLowerCase():""})),r.registerHelper("toUpperCase",(function(e){return e&&"string"==typeof e?e.toUpperCase():""})),r.registerHelper("splitFill",(function(e,r,n){var t=e.split(r);return new Array(t.length).join(n)+t[t.length-1]})),r.registerHelper("each_compare_list_field",(function(e,r,n){var t=n.hash.field,i=[];e&&e.forEach((function(e){var r=e;r.key=e[t],i.push(r)}));var a=[];return r&&r.forEach((function(e){var r=e;r.key=e[t],a.push(r)})),c("key",i,a,n)})),r.registerHelper("each_compare_keys",(function(e,r,n){var t=[];e&&Object.keys(e).forEach((function(r){var n={};n.value=e[r],n.key=r,t.push(n)}));var i=[];r&&Object.keys(r).forEach((function(e){var n={};n.value=r[e],n.key=e,i.push(n)}));return c("key",t,i,n)})),r.registerHelper("each_compare_field",(function(e,r,n){return c("field",e,r,n)})),r.registerHelper("each_compare_title",(function(e,r,n){return c("title",e,r,n)})),r.registerHelper("showDiff",(function(e,r,n){var t="";if(e===r)t=e;else{if(!e)return r;if(!r)return e;var i=o.diff_main(r,e);o.diff_cleanupSemantic(i),t=(t=o.diff_prettyHtml(i)).replace(/&para;/gm,"")}return"nl2br"===n&&(t=a(t)),t}));var o=new n;return n.prototype.diff_prettyHtml=function(e){for(var r=[],n=/&/g,t=/</g,i=/>/g,a=/\n/g,c=0;c<e.length;c++){var o=e[c][0],s=e[c][1].replace(n,"&amp;").replace(t,"&lt;").replace(i,"&gt;").replace(a,"&para;<br>");switch(o){case DIFF_INSERT:r[c]="<ins>"+s+"</ins>";break;case DIFF_DELETE:r[c]="<del>"+s+"</del>";break;case DIFF_EQUAL:r[c]="<span>"+s+"</span>"}}return r.join("")},r}));