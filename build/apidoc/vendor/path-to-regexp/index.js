var isArray=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)},PATH_REGEXP=new RegExp(["(\\\\.)","([\\/.])?(?:\\:(\\w+)(?:\\(((?:\\\\.|[^)])*)\\))?|\\(((?:\\\\.|[^)])*)\\))([+*?])?","([.+*?=^!:${}()[\\]|\\/])"].join("|"),"g");function escapeGroup(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function attachKeys(e,r){return e.keys=r,e}function flags(e){return e.sensitive?"":"i"}function regexpToRegexp(e,r){var t=e.source.match(/\((?!\?)/g);if(t)for(var n=0;n<t.length;n++)r.push({name:n,delimiter:null,optional:!1,repeat:!1});return attachKeys(e,r)}function arrayToRegexp(e,r,t){for(var n=[],a=0;a<e.length;a++)n.push(pathToRegexp(e[a],r,t).source);return attachKeys(new RegExp("(?:"+n.join("|")+")",flags(t)),r)}function replacePath(e,r){var t=0;return e.replace(PATH_REGEXP,(function(e,n,a,i,o,p,u,c){if(n)return n;if(c)return"\\"+c;var s="+"===u||"*"===u,g="?"===u||"*"===u;return r.push({name:i||t++,delimiter:a||"/",optional:g,repeat:s}),a=a?"\\"+a:"",o=escapeGroup(o||p||"[^"+(a||"\\/")+"]+?"),s&&(o=o+"(?:"+a+o+")*"),g?"(?:"+a+"("+o+"))?":a+"("+o+")"}))}function pathToRegexp(e,r,t){if(isArray(r=r||[])?t||(t={}):(t=r,r=[]),e instanceof RegExp)return regexpToRegexp(e,r,t);if(isArray(e))return arrayToRegexp(e,r,t);var n=t.strict,a=!1!==t.end,i=replacePath(e,r),o="/"===e.charAt(e.length-1);return n||(i=(o?i.slice(0,-2):i)+"(?:\\/(?=$))?"),i+=a?"$":n&&o?"":"(?=\\/|$)",attachKeys(new RegExp("^"+i,flags(t)),r)}